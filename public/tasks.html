<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tasks</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root { --brand:#0066ff; --bg:#f8fafc; --text:#111827; --muted:#6b7280; --card:#ffffff; --border:#e5e7eb; }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin:0; font-family:'Inter', system-ui, -apple-system, sans-serif; background-color: var(--bg); color: var(--text); }
    .app { max-width: 390px; margin: 0 auto; min-height: 100%; position: relative; padding-bottom: 84px; }
    .header { position: sticky; top:0; background: var(--bg); border-bottom:1px solid var(--border); z-index: 20; }
    .header-inner { display:flex; align-items:center; justify-content:space-between; padding: 0.75rem 1rem; }
    .title { font-weight: 700; font-size: 1.1rem; }
    .content { padding: 0.75rem 1rem 1rem; }
    .card { background: var(--card); border:1px solid var(--border); border-radius: 16px; padding: 0.75rem; box-shadow: 0 1px 0 rgba(0,0,0,0.04); }
    .label { color:var(--muted); font-size:0.85rem; }
    .list { margin-top:0.75rem; display:grid; gap:0.5rem; }
    .task-card { display:flex; gap:10px; align-items:flex-start; padding:12px; border:1px solid var(--border); border-radius:14px; background:#fff; }
    .checkbox { width:24px; height:24px; border-radius:999px; border:2px solid #d1d5db; display:flex; align-items:center; justify-content:center; color:#fff; }
    .checkbox.checked { background:#1d4ed8; border-color:#1d4ed8; }
    .task-body { flex:1; }
    .task-title { font-weight:600; }
    .task-meta { font-size:12px; color:#6b7280; display:flex; gap:6px; margin-top:4px; }
    .pill { font-size:11px; background:#eef2ff; color:#1d4ed8; padding:2px 6px; border-radius:999px; }
    .progress { height:8px; border-radius:999px; background:#e5e7eb; overflow:hidden; margin-top:12px; }
    .progress > div { height:100%; background: var(--brand); width: 0%; transition: width .3s ease; }
    .filters { display:flex; gap:8px; margin-top:12px; }
    .filter { padding:6px 10px; border-radius:999px; border:1px solid var(--border); cursor:pointer; }
    .filter.active { background:#1d4ed8; color:white; border-color:#1d4ed8; }
    .add-bar { display:flex; gap:8px; margin-top:0.75rem; }
    .input { flex:1; border:1px solid var(--border); border-radius:12px; padding:0.5rem 0.75rem; font-size:0.95rem; }
    .btn { padding: 0.5rem 0.75rem; border-radius: 10px; border:1px solid transparent; background: var(--brand); color: #ffffff; font-weight: 600; font-size: 0.9rem; cursor:pointer; transition: background-color .15s ease, box-shadow .15s ease, filter .15s ease; }
    .btn:hover { filter: brightness(0.95); }
    .btn:active { filter: brightness(0.9); }
    .btn:focus-visible { outline: 2px solid var(--brand); outline-offset: 2px; }
    .btn[disabled] { opacity: 0.6; cursor: not-allowed; }
    .filter.active { background:#1d4ed8; color:white; border-color:#1d4ed8; }
    .add-bar { display:flex; gap:8px; margin-top:0.75rem; }
    .input { flex:1; border:1px solid var(--border); border-radius:12px; padding:0.5rem 0.75rem; font-size:0.95rem; }
    .btn { padding: 0.5rem 0.75rem; border-radius: 10px; border:1px solid var(--border); background: #fff; color: var(--text); font-weight: 600; font-size: 0.9rem; cursor:pointer; }

    /* Bottom Navigation Styles */
    .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; display: flex; justify-content: space-around; align-items: center; background-color: white; padding: 0.75rem 1rem; z-index: 10; max-width: 390px; margin: 0 auto; border-top: 1px solid #f0f0f0; }
    .bottom-nav-item { display:flex; flex-direction:column; align-items:center; justify-content:center; color:#9ca3af; position:relative; text-decoration:none; }
    .bottom-nav-item.active { color: var(--brand); }
    .bottom-nav-text { font-size: 0.75rem; }
    .bottom-nav-indicator { position: absolute; bottom: -12px; left: 0; right: 0; margin: 0 auto; width: 24px; height: 2px; background-color: var(--brand); }
    .bottom-bar { display: none !important; }
    .bottom-nav-icon { margin-bottom: 0.25rem; height: 24px; }

    /* Dark mode variables and overrides */
    .dark { --brand:#60a5fa; --bg:#0b1220; --text:#e5e7eb; --muted:#9ca3af; --card:#111827; --border:#1f2937; }
    .dark .header { background: var(--bg); border-bottom-color: var(--border); }
    .dark .card { background: var(--card); border-color: var(--border); }
    .dark .bottom-nav { background-color: var(--card); border-top-color: var(--border); }
    .dark .bottom-bar { background-color: var(--border); }
    .dark .check-item { background: var(--card); border-color: var(--border); }
    .dark .item-subtitle { color:#9ca3af; }
    .dark .icon-pill { background:#1f2937; color:#93c5fd; box-shadow: inset 0 0 0 1px var(--border); }
    .dark .donut::after { background: var(--card); }

    /* Checklist styles inspired by mock */
    .checklist { display:flex; flex-direction:column; gap:12px; }
    .check-item { display:flex; gap:12px; align-items:center; background:#f9fafb; border:1px solid var(--border); border-radius:16px; padding:12px; box-shadow: 0 1px 0 rgba(0,0,0,0.03); }
    .icon-pill { width:40px; height:40px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:#eef2ff; color:#1d4ed8; box-shadow: inset 0 0 0 1px #e5e7eb; cursor:pointer; }
    .icon-pill svg { width:20px; height:20px; }
    .icon-pill:focus-visible { outline: 2px solid var(--brand); outline-offset: 2px; }
    .icon-pill.done { background:#dcfce7; color:#10b981; box-shadow:none; }
    .item-text { flex:1; }
    .item-title { font-weight:600; }
    .item-subtitle { color:#6b7280; font-size:13px; }

    .progress-card { display:flex; align-items:center; justify-content:space-between; }
    .donut { --pct: 0%; width:48px; height:48px; border-radius:50%; background: conic-gradient(var(--brand) var(--pct), #e5e7eb 0); position:relative; }
    .donut::after { content:''; position:absolute; inset:6px; background:white; border-radius:50%; }

  </style>
</head>
<body>
    <script>document.documentElement.classList.add('dark');</script>
    <div class="app">
    <div class="header">
      <div class="header-inner">
        <div class="title" id="title">Tasks</div>
      </div>
    </div>

    <div class="content">
      <div class="card">
        <div class="label">Project</div>
        <div id="projectName" style="font-weight:600">â€”</div>
      </div>

      <div class="card" style="margin-top:0.75rem">
        <div class="label">Getting Started</div>
        <div class="checklist" id="tasks"></div>
        <div class="add-bar" style="margin-top:12px">
          <input id="newTaskInput" class="input" placeholder="New task" />
          <button id="addTaskBtn" class="btn">Add</button>
        </div>
      </div>

      <div class="card" style="margin-top:0.75rem">
        <div class="progress-card">
          <div class="label">Getting Started: <span id="progressText">0%</span></div>
          <div class="donut" id="progressDonut"></div>
        </div>
      </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
      <a href="overview.html" class="bottom-nav-item" aria-label="Home">
        <div class="bottom-nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
        </div>
        <span class="bottom-nav-text">Home</span>
      </a>
      <a href="projects.html" class="bottom-nav-item active" aria-label="Projects">
        <div class="bottom-nav-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM5 19V5H19V19H5Z" fill="currentColor"/>
            <path d="M7 7H17V9H7V7ZM7 11H17V13H7V11ZM7 15H14V17H7V15Z" fill="currentColor"/>
          </svg>
        </div>
        <span class="bottom-nav-text">Projects</span>
        <div class="bottom-nav-indicator"></div>
      </a>
      <a href="pal.html" class="bottom-nav-item" aria-label="PAL">
        <div class="bottom-nav-icon">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          </svg>
        </div>
        <span class="bottom-nav-text">Pal</span>
      </a>
      <a href="wallet.html" class="bottom-nav-item" aria-label="Wallet">
        <div class="bottom-nav-icon">
          <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect x="2" y="5" width="20" height="14" rx="2"></rect>
            <path d="M2 9h20"></path>
          </svg>
        </div>
        <span class="bottom-nav-text">Wallet</span>
      </a>
    </nav>
    <!-- bottom spacer removed -->
  </div>

  <script>
    function getProjectFromQuery() {
      const params = new URLSearchParams(window.location.search);
      return params.get('project') || 'Project';
    }

    function defaultTasks(project){
      // Checklist inspired by the mock
      return [
        { id:'1', title:'Update your profile', subtitle:'Add a photo and connect your social links.', icon:'check', color:'#10b981', done:true },
        { id:'2', title:'Write your first post', subtitle:'Share your voice â€“ start creating today.', icon:'doc', color:'#a78bfa', done:false },
        { id:'3', title:'Plan your first post', subtitle:'Pick the perfect time to publish.', icon:'calendar', color:'#f59e0b', done:false },
        { id:'4', title:'Create your first link', subtitle:'Make a trackable link to share.', icon:'link', color:'#10b981', done:true },
        { id:'5', title:"Explore todayâ€™s inspiration", subtitle:'Spark ideas with fresh content.', icon:'bulb', color:'#60a5fa', done:false }
      ];
    }

    function getTasksKey(project){ return `tasks:${project}`; }
    function readTasks(project){ return JSON.parse(localStorage.getItem(getTasksKey(project))||'null') || defaultTasks(project); }
    function writeTasks(project, list){ localStorage.setItem(getTasksKey(project), JSON.stringify(list)); }

    function iconSvg(name){
      if (name==='check') return '<svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 12l5 5L21 4"/></svg>';
      if (name==='doc') return '<svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="6" y="4" width="12" height="16" rx="2"></rect><path d="M8 8h8M8 12h8M8 16h8"></path></svg>';
      if (name==='calendar') return '<svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2"></rect><path d="M16 2v4M8 2v4M3 10h18"></path></svg>';
      if (name==='link') return '<svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 1 7 0l1 1a5 5 0 0 1-7 7l-1-1"></path><path d="M14 11a5 5 0 0 0-7 0l-1 1a5 5 0 0 0 7 7l1-1"></path></svg>';
      if (name==='bulb') return '<svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18h6"/><path d="M10 22h4"/><path d="M12 2a7 7 0 0 1 7 7c0 2.2-1.1 4.2-2.9 5.5L16 16H8l-0.1-1.5A6.9 6.9 0 0 1 5 9a7 7 0 0 1 7-7z"/></svg>';
      return '<svg class="icon" viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle></svg>';
    }

    function hexToRgb(hex){
      const h = hex.replace('#','');
      const bigint = parseInt(h, 16);
      return { r: (bigint >> 16) & 255, g: (bigint >> 8) & 255, b: bigint & 255 };
    }
    function tint(hex, alpha){
      const { r, g, b } = hexToRgb(hex);
      return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }

    function renderProgress(list){
      const total = list.length || 1;
      const done = list.filter(t=>t.done).length;
      const pct = Math.round((done/total)*100);
      document.getElementById('progressText').textContent = pct + '%';
      const donut = document.getElementById('progressDonut');
      if (donut) donut.style.setProperty('--pct', pct + '%');
    }

    function renderTasks(project){
      const list = readTasks(project);
      const container = document.getElementById('tasks');
      container.innerHTML = '';
      list.forEach(t=>{
        const row = document.createElement('div');
        row.className = 'check-item';
        const pillStyle = t.done ? 'icon-pill done' : 'icon-pill';
        const pillContent = t.done ? iconSvg('check') : iconSvg(t.icon);
        const isDark = document.documentElement.classList.contains('dark');
        const baseColor = (typeof t.color === 'string' && t.color) ? t.color : '#60a5fa';
        const bg = t.done ? '' : tint(baseColor, isDark ? 0.24 : 0.13);
        const pillColor = t.done ? '' : `style="background:${bg}; color:${baseColor}"`;
        row.innerHTML = `
          <button class="${pillStyle}" data-id="${t.id}" aria-label="Toggle task completion" aria-pressed="${t.done ? 'true' : 'false'}" ${pillColor}>${pillContent}</button>
          <div class="item-text">
            <div class="item-title">${t.title||t.text||''}</div>
            <div class="item-subtitle">${t.subtitle||''}</div>
          </div>
        `;
        container.appendChild(row);
      });
      renderProgress(list);
    }

    function toggleTask(project, id){
      const list = readTasks(project);
      const idx = list.findIndex(x=>x.id===id);
      if (idx>=0){ list[idx].done = !list[idx].done; writeTasks(project, list); }
    }

    function addTask(project) {
      const text = document.getElementById('newTaskInput').value.trim();
      if (!text) return;
      const list = readTasks(project);
      list.push({ id: String(Date.now()), title:text, subtitle:'', icon:'doc', color:'#a78bfa', done:false });
      writeTasks(project, list);
      document.getElementById('newTaskInput').value='';
      renderTasks(project);
    }

    document.addEventListener('DOMContentLoaded', () => {
      const project = getProjectFromQuery();
      document.getElementById('projectName').textContent = project;
      renderTasks(project);
      document.getElementById('addTaskBtn').addEventListener('click', () => addTask(project));
      document.getElementById('tasks').addEventListener('click', (e)=>{
        const btn = e.target.closest('.icon-pill');
        if (!btn) return;
        toggleTask(project, btn.getAttribute('data-id'));
        renderTasks(project);
      });
    });
  </script>
</body>
</html>
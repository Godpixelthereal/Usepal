<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard | PAL - AI Business Partner</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #007bff;
        }
        body {
            background-color: #f8fafc;
            font-family: 'Inter', sans-serif;
        }
        .btn-primary {
            background-color: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
        }
        .card {
            background-color: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 1.5rem;
        }
        .nav-link {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border-radius: 0.375rem;
            color: #4b5563;
            margin-bottom: 0.5rem;
        }
        .nav-link.active {
            background-color: var(--primary-color);
            color: white;
        }
        .nav-link:hover:not(.active) {
            background-color: #f3f4f6;
        }
    </style>
    <style>
        /* Dark mode overrides */
        .dark body { background-color:#0b1220; color:#e5e7eb; }
        .dark aside { background-color:#111827; color:#e5e7eb; }
        .dark .card { background-color:#111827; color:#e5e7eb; }
        .dark .nav-link { color:#9ca3af; }
        .dark .nav-link.active { background-color:#2563eb; color:#ffffff; }
        .dark .bottom-nav { background-color:#111827; border-top-color:#1f2937; }
        .dark .bottom-bar { background-color:#1f2937; }

        /* Bottom Navigation Styles for mobile */
      .bottom-nav { position: fixed; bottom: 0; left: 0; right: 0; display: flex; justify-content: space-around; align-items: center; background-color: white; padding: 0.75rem 1rem; z-index: 10; max-width: 390px; margin: 0 auto; border-top: 1px solid #f0f0f0; }
      .bottom-nav-item { display:flex; flex-direction:column; align-items:center; justify-content:center; color:#9ca3af; position:relative; text-decoration:none; }
      .bottom-nav-item.active { color:#0066ff; }
      .bottom-nav-icon { margin-bottom: 0.25rem; height: 24px; }
      .bottom-nav-text { font-size: 0.75rem; }
      .bottom-nav-indicator { position: absolute; bottom: -12px; left: 0; right: 0; margin: 0 auto; width: 24px; height: 2px; background-color: #0066ff; }
      .bottom-bar { position: fixed; bottom: 0; left: 0; right: 0; height: 5px; background-color: #e5e7eb; z-index: 5; max-width: 390px; margin: 0 auto; }

      /* Responsive additions */
      .card canvas { width: 100% !important; height: auto !important; }
      @media (min-width: 641px){ .bottom-nav, .bottom-bar { max-width: 640px; } }
      @media (min-width: 901px){ .bottom-nav, .bottom-bar { max-width: 900px; } }
      @media (max-width: 640px){ .card { padding: 1.25rem; } }
      @media (max-width: 480px){ .card h3 { font-size: clamp(1rem, 3.6vw, 1.125rem); } }
    </style>
</head>
<body>
    <script>document.documentElement.classList.add('dark');</script>
    <div class="min-h-screen flex">
        <!-- Sidebar Navigation -->
        <aside class="w-64 bg-white shadow-md hidden md:block">
            <div class="p-4">
                <h1 class="text-xl font-bold text-gray-900">PAL</h1>
                <p class="text-sm text-gray-500">AI Business Partner</p>
            </div>
            <nav class="mt-6 px-4">
                <a href="dashboard.html" class="nav-link active">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3 4a1 1 0 011-1h12a1 1 0 011 1v2a1 1 0 01-1 1H4a1 1 0 01-1-1V4zM3 10a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H4a1 1 0 01-1-1v-6zM14 9a1 1 0 00-1 1v6a1 1 0 001 1h2a1 1 0 001-1v-6a1 1 0 00-1-1h-2z"></path>
                    </svg>
                    Dashboard
                </a>
                <a href="projects.html" class="nav-link">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path>
                    </svg>
                    Projects
                </a>
                <a href="pal.html" class="nav-link">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M2 5a2 2 0 012-2h7a2 2 0 012 2v4a2 2 0 01-2 2H9l-3 3v-3H4a2 2 0 01-2-2V5z"></path>
                        <path d="M15 7v2a4 4 0 01-4 4H9.828l-1.766 1.767c.28.149.599.233.938.233h2 l3 3v-3h2a2 2 0 002-2V9a2 2 0 00-2-2h-1z"></path>
                    </svg>
                    PAL
                </a>
                <a href="reports.html" class="nav-link">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 3h12a1 1 0 011 1v12a1 1 0 01-1 1H4a1 1 0 01-1-1V4a1 1 0 011-1zm2 4h8v2H6V7zm0 4h8v2H6v-2z"></path>
                    </svg>
                    Reports
                </a>
                <a href="notifications.html" class="nav-link">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 2a6 6 0 00-6 6v3.586l-1.707 1.707A1 1 0 003 15h14a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zm0 16a2 2 0 002-2H8a2 2 0 002 2z"></path>
                    </svg>
                    Notifications
                </a>
                <a href="settings.html" class="nav-link">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"></path>
                    </svg>
                    Settings
                </a>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col">
            <!-- Mobile Header -->
            <header class="bg-white shadow-sm md:hidden">
                <div class="px-4 py-3 flex justify-between items-center">
                    <h1 class="text-xl font-bold text-gray-900">PAL</h1>
                    <button id="mobileMenuBtn" class="text-gray-500 focus:outline-none">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
                <!-- Mobile Menu -->
                <div id="mobileMenu" class="hidden px-4 py-2 pb-4">
                    <a href="dashboard.html" class="block py-2 px-4 text-sm rounded bg-blue-500 text-white mb-1">Dashboard</a>
                    <a href="projects.html" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100 rounded mb-1">Projects</a>
                    <a href="pal.html" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100 rounded mb-1">PAL</a>
                    <a href="reports.html" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100 rounded mb-1">Reports</a>
                    <a href="notifications.html" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100 rounded mb-1">Notifications</a>
                    <a href="settings.html" class="block py-2 px-4 text-sm text-gray-700 hover:bg-gray-100 rounded">Settings</a>
                </div>
            </header>

            <!-- Dashboard Content -->
            <main class="flex-1 overflow-y-auto p-4 md:p-6">
                <div class="max-w-7xl mx-auto">
                    <!-- Business Info Header -->
                    <div class="mb-6">
                        <h1 class="text-2xl font-bold text-gray-900" id="businessName">Dashboard</h1>
                        <p class="text-gray-500" id="businessCategory">Loading business data...</p>
                    </div>

                    <!-- Summary Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="card bg-white">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Sales</h3>
                            <p class="text-2xl font-bold text-gray-900" id="salesAmount">$0</p>
                            <p class="text-sm text-green-500" id="salesChange">+0% from last month</p>
                        </div>
                        <div class="card bg-white">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Expenses</h3>
                            <p class="text-2xl font-bold text-gray-900" id="expensesAmount">$0</p>
                            <p class="text-sm text-red-500" id="expensesChange">+0% from last month</p>
                        </div>
                        <div class="card bg-white">
                            <h3 class="text-lg font-medium text-gray-700 mb-2">Profit</h3>
                            <p class="text-2xl font-bold text-gray-900" id="profitAmount">$0</p>
                            <p class="text-sm text-green-500" id="profitChange">+0% from last month</p>
                        </div>
                    </div>

                    <!-- Charts -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                        <div class="card">
                            <h3 class="text-lg font-medium text-gray-700 mb-4">Financial Performance</h3>
                            <div class="h-64">
                                <canvas id="financialChart"></canvas>
                            </div>
                        </div>
                        <div class="card">
                            <h3 class="text-lg font-medium text-gray-700 mb-4">Expense Breakdown</h3>
                            <div class="h-64">
                                <canvas id="expenseChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Smart Alerts -->
                    <div class="card mb-6">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-medium text-gray-700">Smart Alerts</h3>
                            <span class="text-sm text-gray-500">Last updated: Today</span>
                        </div>
                        <div id="alertsContainer">
                            <div class="p-4 rounded-md bg-blue-50 mb-3">
                                <div class="flex">
                                    <div class="flex-shrink-0">
                                        <svg class="h-5 w-5 text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                                            <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                        </svg>
                                    </div>
                                    <div class="ml-3">
                                        <h3 class="text-sm font-medium text-blue-800">Welcome to your dashboard!</h3>
                                        <div class="mt-2 text-sm text-blue-700">
                                            <p>This is where you'll see AI-generated insights about your business performance.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script>
        // Mobile menu toggle
        document.getElementById('mobileMenuBtn').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobileMenu');
            mobileMenu.classList.toggle('hidden');
        });

        // Load business data
        window.addEventListener('DOMContentLoaded', function() {
            const businessData = JSON.parse(localStorage.getItem('businessData')) || {
                name: 'Demo Business',
                category: 'Technology',
                dailyBudget: 100
            };

            document.getElementById('businessName').textContent = businessData.name + ' Dashboard';
            document.getElementById('businessCategory').textContent = businessData.category;

            // Mock data
            const mockData = {
                sales: {
                    amount: 12580,
                    change: 8.5
                },
                expenses: {
                    amount: 8340,
                    change: 2.3
                },
                profit: {
                    amount: 4240,
                    change: 12.7
                },
                financialData: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [
                        {
                            label: 'Sales',
                            data: [8000, 9200, 10100, 11500, 11900, 12580],
                            borderColor: '#2563eb',
                            backgroundColor: 'rgba(37, 99, 235, 0.12)',
                            tension: 0.4,
                            borderWidth: 2,
                            pointRadius: 2,
                            pointHoverRadius: 4
                        },
                        {
                            label: 'Expenses',
                            data: [6000, 6800, 7200, 7900, 8100, 8340],
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.12)',
                            tension: 0.4,
                            borderWidth: 2,
                            borderDash: [6, 4],
                            pointRadius: 0
                        }
                    ]
                },
                expenseData: {
                    labels: ['Marketing', 'Operations', 'Payroll', 'Software', 'Office', 'Other'],
                    datasets: [{
                        data: [25, 20, 30, 10, 10, 5],
                        backgroundColor: [
                            '#007bff', '#28a745', '#ffc107', '#17a2b8', '#6c757d', '#dc3545'
                        ]
                    }]
                },
                alerts: [
                    {
                        type: 'info',
                        title: 'Cash flow forecast',
                        message: 'Based on current trends, you\'ll have a positive cash flow of approximately $5,200 next month.'
                    },
                    {
                        type: 'warning',
                        title: 'Marketing expense increase',
                        message: 'Your marketing expenses have increased by 15% compared to last month. Consider reviewing your marketing strategy.'
                    }
                ]
            };

            // Update summary cards
            document.getElementById('salesAmount').textContent = '$' + mockData.sales.amount.toLocaleString();
            document.getElementById('salesChange').textContent = '+' + mockData.sales.change + '% from last month';
            
            document.getElementById('expensesAmount').textContent = '$' + mockData.expenses.amount.toLocaleString();
            document.getElementById('expensesChange').textContent = '+' + mockData.expenses.change + '% from last month';
            
            document.getElementById('profitAmount').textContent = '$' + mockData.profit.amount.toLocaleString();
            document.getElementById('profitChange').textContent = '+' + mockData.profit.change + '% from last month';

            // Add computed profit series and theme-aware helpers
            const isDark = document.documentElement.classList.contains('dark');
            const currency = (v) => '$' + (v || 0).toLocaleString();
            const profitSeries = mockData.financialData.datasets[0].data.map((s, i) => s - mockData.financialData.datasets[1].data[i]);
            mockData.financialData.datasets.push({
                label: 'Profit',
                data: profitSeries,
                borderColor: '#10b981',
                backgroundColor: 'rgba(16, 185, 129, 0.12)',
                tension: 0.4,
                borderWidth: 3,
                pointRadius: 2,
                pointHoverRadius: 4,
                fill: true
            });

            // Create financial chart
            const financialCtx = document.getElementById('financialChart').getContext('2d');
            new Chart(financialCtx, {
                type: 'line',
                data: mockData.financialData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                color: isDark ? '#e5e7eb' : '#374151',
                                boxWidth: 12,
                                padding: 16
                            }
                        },
                        title: {
                            display: true,
                            text: 'Financial Performance',
                            color: isDark ? '#e5e7eb' : '#111827',
                            font: { weight: '600', size: 16 }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label || '';
                                    const value = context.parsed.y || 0;
                                    return `${label}: ${currency(value)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Month',
                                color: isDark ? '#e5e7eb' : '#374151',
                                font: { weight: '500' }
                            },
                            ticks: { color: isDark ? '#e5e7eb' : '#6b7280' },
                            grid: { display: false }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Amount ($)',
                                color: isDark ? '#e5e7eb' : '#374151',
                                font: { weight: '500' }
                            },
                            ticks: {
                                color: isDark ? '#e5e7eb' : '#6b7280',
                                callback: function(value) { return '$' + value.toLocaleString(); }
                            },
                            grid: { color: isDark ? '#374151' : 'rgba(0,0,0,0.05)' },
                            beginAtZero: true
                        }
                    },
                    elements: {
                        line: { borderCapStyle: 'round', borderJoinStyle: 'round' },
                        point: { radius: 3, hoverRadius: 5 }
                    }
                }
            });

            // Create expense chart
            const expenseCtx = document.getElementById('expenseChart').getContext('2d');
            new Chart(expenseCtx, {
                type: 'doughnut',
                data: mockData.expenseData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                        }
                    }
                }
            });

            // Add alerts
            const alertsContainer = document.getElementById('alertsContainer');
            alertsContainer.innerHTML = ''; // Clear default alert
            
            mockData.alerts.forEach(alert => {
                let colorClass = 'blue';
                if (alert.type === 'warning') colorClass = 'yellow';
                if (alert.type === 'danger') colorClass = 'red';
                
                const alertHtml = `
                    <div class="p-4 rounded-md bg-${colorClass}-50 mb-3">
                        <div class="flex">
                            <div class="flex-shrink-0">
                                <svg class="h-5 w-5 text-${colorClass}-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                                </svg>
                            </div>
                            <div class="ml-3">
                                <h3 class="text-sm font-medium text-${colorClass}-800">${alert.title}</h3>
                                <div class="mt-2 text-sm text-${colorClass}-700">
                                    <p>${alert.message}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
                
                alertsContainer.innerHTML += alertHtml;
            });
        });
    </script>
    <nav class="bottom-nav md:hidden">
      <a href="overview.html" class="bottom-nav-item active" aria-label="Home">
        <span class="bottom-nav-text">Home</span>
        <div class="bottom-nav-indicator"></div>
      </a>
      <a href="projects.html" class="bottom-nav-item" aria-label="Projects">
        <span class="bottom-nav-text">Projects</span>
      </a>
      <a href="pal.html" class="bottom-nav-item" aria-label="PAL">
        <span class="bottom-nav-text">PAL</span>
      </a>
      <a href="wallet.html" class="bottom-nav-item" aria-label="Wallet">
        <span class="bottom-nav-text">Wallet</span>
      </a>
    </nav>
    <div class="bottom-bar md:hidden"></div>
  </body>
</html>